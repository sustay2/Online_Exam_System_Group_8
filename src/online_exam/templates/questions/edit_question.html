{% extends "base.html" %}

{% block title %}Edit Question - {{ exam.title }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2>Edit Question</h2>
            <p class="text-muted mb-0">Exam: {{ exam.title }}</p>
        </div>
        <div>
            <a href="{{ url_for('question.list_questions', exam_id=exam.id) }}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-1"></i> Back to Questions
            </a>
        </div>
    </div>

    <!-- Form -->
    <div class="card">
        <div class="card-body">
            <form method="POST" action="{{ url_for('question.edit_question', exam_id=exam.id, question_id=question.id) }}">
                <!-- Question Type (Display Only) -->
                <div class="mb-3">
                    <label class="form-label fw-bold">Question Type</label>
                    <div>
                        {% if question.is_mcq() %}
                            <span class="badge bg-primary">Multiple Choice (MCQ)</span>
                        {% else %}
                            <span class="badge bg-warning text-dark">Written (Open-ended)</span>
                        {% endif %}
                        <small class="text-muted d-block mt-1">Question type cannot be changed after creation</small>
                    </div>
                </div>

                <!-- Question Text -->
                <div class="mb-3">
                    <label for="question_text" class="form-label fw-bold">Question Text <span class="text-danger">*</span></label>
                    <textarea class="form-control" id="question_text" name="question_text" rows="4" required>{{ question.question_text }}</textarea>
                </div>

                <!-- Points -->
                <div class="mb-3">
                    <label for="points" class="form-label fw-bold">Points <span class="text-danger">*</span></label>
                    <input type="number" class="form-control" id="points" name="points" min="1" max="100" value="{{ question.points }}" required style="max-width: 150px;">
                    <small class="text-muted">Enter the number of points this question is worth (1-100)</small>
                </div>

                <!-- MCQ Options (shown only for MCQ type) -->
                {% if question.is_mcq() %}
                <div class="border rounded p-3 bg-light">
                    <h5 class="mb-3">Multiple Choice Options</h5>

                    <div class="mb-3">
                        <label for="option_a" class="form-label fw-bold">Option A <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="option_a" name="option_a" value="{{ question.option_a }}" required>
                    </div>

                    <div class="mb-3">
                        <label for="option_b" class="form-label fw-bold">Option B <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="option_b" name="option_b" value="{{ question.option_b }}" required>
                    </div>

                    <div class="mb-3">
                        <label for="option_c" class="form-label fw-bold">Option C <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="option_c" name="option_c" value="{{ question.option_c }}" required>
                    </div>

                    <div class="mb-3">
                        <label for="option_d" class="form-label fw-bold">Option D <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="option_d" name="option_d" value="{{ question.option_d }}" required>
                    </div>

                    <div class="mb-3">
                        <label for="correct_answer" class="form-label fw-bold">Correct Answer <span class="text-danger">*</span></label>
                        <select class="form-select" id="correct_answer" name="correct_answer" required style="max-width: 150px;">
                            <option value="A" {% if question.correct_answer == 'A' %}selected{% endif %}>A</option>
                            <option value="B" {% if question.correct_answer == 'B' %}selected{% endif %}>B</option>
                            <option value="C" {% if question.correct_answer == 'C' %}selected{% endif %}>C</option>
                            <option value="D" {% if question.correct_answer == 'D' %}selected{% endif %}>D</option>
                        </select>
                    </div>
                </div>
                {% endif %}

                <!-- Submit Buttons -->
                <div class="mt-4">
                    <button type="submit" class="btn btn-warning">
                        <i class="bi bi-save me-1"></i> Save Changes
                    </button>
                    <a href="{{ url_for('question.list_questions', exam_id=exam.id) }}" class="btn btn-outline-secondary ms-2">
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}